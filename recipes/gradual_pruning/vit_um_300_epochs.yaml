training_modifiers:

  - !EpochRangeModifier
    start_epoch: 0
    end_epoch: 300
  
  - !LearningRateFunctionModifier
    start_epoch: 0
    end_epoch: 200
    lr_func: cyclic_linear
    init_lr: 0.0001
    final_lr: 0.000001
    cycle_epochs: 5.0   

  - !LearningRateFunctionModifier
    start_epoch: 200
    end_epoch: 300
    lr_func: cosine
    init_lr: 0.0001
    final_lr: 0.00001
  
pruning_modifiers:
    
 - !GlobalMagnitudePruningModifier
    params: ['re:(.*blocks.*.attn.qkv.weight)|(.*blocks.*.attn.proj.weight)|(.*blocks.*.mlp.fc.*weight)']
    init_sparsity: 0.1
    final_sparsity: 0.6
    start_epoch: 0.0
    end_epoch: 200.0
    update_frequency: 5.0
    num_recompute: 5
    num_calibration_steps: 5000
    calibration_batch_size: 32
    calibration_lr: 0.1
    calibration_momentum: 0.9
    modules: '(.*blocks.*.attn.qkv)|(.*blocks.*.attn.proj$)|(.*blocks.*.mlp.fc.*)'
    inter_func: cubic
    leave_enabled: True
    mask_type: unstructured

 - !GlobalMagnitudePruningModifier
    params: ['re:(.*blocks.*.attn.qkv.weight)|(.*blocks.*.attn.proj.weight)|(.*blocks.*.mlp.fc.*weight)']
    init_sparsity: 0.6
    final_sparsity: 0.6
    start_epoch: 200.0
    end_epoch: 300.0
    update_frequency: 100
    num_recompute: 5
    num_calibration_steps: 5000
    calibration_batch_size: 32
    calibration_lr: 0.1
    calibration_momentum: 0.9
    modules: '(.*blocks.*.attn.qkv)|(.*blocks.*.attn.proj$)|(.*blocks.*.mlp.fc.*)'
    inter_func: cubic
    leave_enabled: True
    mask_type: unstructured
    