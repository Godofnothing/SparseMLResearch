training_modifiers:
  
  - !EpochRangeModifier
    start_epoch: 0
    end_epoch: 600
  
  - !LearningRateFunctionModifier
    start_epoch: 0
    end_epoch: 20
    lr_func: linear
    init_lr: 0.000001
    final_lr: 0.0007

  - !LearningRateFunctionModifier
    start_epoch: 20
    end_epoch: 600
    lr_func: cosine
    init_lr: 0.0007
    final_lr: 0.000001
  
pruning_modifiers:

  - !ACDCMFACPruningModifier
    compression_sparsity: 0.6
    start_epoch: 150
    end_epoch: 475
    update_frequency: 25
    params: ['re:(.*blocks.*.attn.qkv.weight)|(.*blocks.*.attn.proj.weight)|(.*blocks.*.mlp.fc.*weight)'] 
    mask_type: unstructured
    global_sparsity : True
    num_grads: 256
    fisher_block_size: 64
    damp: 0.0000001
    grad_device: cpu


  - !MFACPruningModifier
    init_sparsity: 0.6
    final_sparsity: 0.6
    start_epoch: 525
    end_epoch: 600
    update_frequency: 75
    params: ['re:(.*blocks.*.attn.qkv.weight)|(.*blocks.*.attn.proj.weight)|(.*blocks.*.mlp.fc.*weight)'] 
    mask_type: unstructured
    global_sparsity : True
    num_grads: 256
    fisher_block_size: 64
    damp: 0.0000001
    grad_device: cpu
